Issue author: @visch (null)
PR plan author: @phaedrusflow (https://github.com/phaedrusflow)
Organization: @qompassai (https://github.com/qompassai)
Author IDs: \[user-id: 70476764] \[org-id: 137334444]

# WIP PR plan for #4200 – Black screen after laptop wake from sleep on NVIDIA GPUs

Labels: bug
Repo: basecamp/omarchy
Upstream issue: https://github.com/basecamp/omarchy/issues/4200

***

## Legend

* **D#** – Diff / behavior change
* **F#** – File added/changed/removed
* **T#** – Test / verification step
* **R#** – References

***

## Summary

* \[NVIDIA AQ\_DRM misconfiguration/suspend behavior/app flags/dkms modules]
* Lines: \[`<file>#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/<path>#Lxx-Lyy>)

## Upstream issue context (snippet)

```text
### System details

Framework Overkill, AMD Ryzen AI 9 HX 370, NVIDIA Gefore RTX 5070

### What's wrong?

When I close and reopen the laptop lid (suspend/resume cycle), the screen stays black. Sometimes requires closing and reopening the lid 2-3 times before the display works again. Not super consistent

I think It's NVIDIA causing it. I haven't made a fix like this to something like an distro but I'll give it a shot
```

## Proposed Changes

* D2: \[describe change #2]
  * Lines: \[`<file>#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/<path>#Lxx-Lyy>)
* D3: \[describe change #3]
  * Lines: \[`<file>#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/<path>#Lxx-Lyy>)
* D4: \[describe change #4]
  * Lines: \[`<file>#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/<path>#Lxx-Lyy>)

## Files

* F1: [`./4200/default/hypr/envs.conf`](./4200/default/hypr/envs.conf)
  * Purpose: \[what this file does in this PR]
  * Lines: \[`envs.conf#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/4200/default/hypr/envs.conf#Lxx-Lyy>)
* F2: [`./4200/default/hypr/start.conf`](./4200/default/hypr/start.conf)
  * Purpose: \[what this file does in this PR]
  * Lines: \[`start.conf#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/4200/default/hypr/start.conf#Lxx-Lyy>)
* F3: [`./4200/install/...`](./4200/install/...)
  * Purpose: \[install / helper scripts]
  * Lines: \[`install#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/4200/install/<path>#Lxx-Lyy>)
* F4: \[additional file]
  * Purpose: \[what this file does]
  * Lines: \[`<file>#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/<path>#Lxx-Lyy>)

## Linked issues

1. \#2800 google-chrome flickers | [link](https://github.com/basecamp/omarchy/issues/2800)
2. \#3899  Chromium GPU/Ozone errors after update to 3.2.3 | [link](https://github.com/basecamp/omarchy/issues/3899)

## PR checklist

* \[ ] D5: \[build & basic tests pass]
* \[ ] D6: \[link this PR to basecamp/omarchy#4200]
* \[ ] D7: \[reference design notes (tracker.md, issue dir)]
* \[ ] D8: \[user-facing PR description written]

## Testing

* T1: \[test description]
  * Lines: \[`<file>#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/<path>#Lxx-Lyy>)
* T2: \[test description]
  * Lines: \[`<file>#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/<path>#Lxx-Lyy>)
* T3: \[test description]
  * Lines: \[`<file>#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/<path>#Lxx-Lyy>)
* T4: \[test description]
  * Lines: \[`<file>#Lxx-Lyy`]\(\<https://github.com/<owner>/<repo>/blob/<sha>/<path>#Lxx-Lyy>)

## References

<!-- <sup><a href="#ref1">[1]</a></sup> -->

<div id="footnotes">
<p id="R1"><strong>[1]</strong> <a href="https://wiki.archlinux.org/title/NVIDIA">Nvidia Arch Wiki</a></p>

<p id="R2"><strong>[2]</strong> <a href="URL_HERE">TITLE_HERE</a></p>

<p id="R3"><strong>[3]</strong> <a href="URL_HERE">TITLE_HERE</a></p>

<p id="R4"><strong>[4]</strong> <a href="URL_HERE">TITLE_HERE</a></p>

<p id="R5"><strong>[5]</strong> <a href="URL_HERE">TITLE_HERE</a></p>
</div>
